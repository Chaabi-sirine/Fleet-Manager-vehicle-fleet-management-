
<div class="dashboard-container">
  <!-- En-tête du Dashboard -->
  <div class="dashboard-header">
    <div class="header-content">
      <h1>
        <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
          <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
        </svg>
        Tableau de Bord SNCFT
      </h1>
      <p>Vue d'ensemble et pilotage en temps réel du parc automobile</p>
    </div>
    <div class="header-actions">
      <button class="btn-refresh" 
              [class.refreshing]="isRefreshing"
              (click)="refreshDashboard()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 9.74C4.46 10.97 4 12.43 4 14c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/>
        </svg>
        {{isRefreshing ? 'Actualisation...' : 'Actualiser'}}
      </button>
      <div class="time-indicator">
        Dernière MAJ: {{formatDateShort(getCurrentTime())}}
      </div>
    </div>
  </div>

  <!-- A. Statistiques Principales (KPI Globaux) -->
  <div class="kpi-section">
    <div class="kpi-grid">
      <div class="kpi-card primary">
        <div class="kpi-icon">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
            <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11C5.84 5 5.28 5.42 5.08 6.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99z"/>
          </svg>
        </div>
        <div class="kpi-content">
          <div class="kpi-value">{{vehicleStats.total}}</div>
          <div class="kpi-label">Véhicules Totaux</div>
          <div class="kpi-details">
            {{vehicleStats.disponible}} disponibles • {{vehicleStats.enMission}} en mission
          </div>
        </div>
        <div class="kpi-trend up">+{{getVehicleStatusPercentage('disponible')}}%</div>
      </div>

      <div class="kpi-card accent">
        <div class="kpi-icon">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
          </svg>
        </div>
        <div class="kpi-content">
          <div class="kpi-value">{{missionStats.enCours}}</div>
          <div class="kpi-label">Missions en Cours</div>
          <div class="kpi-details">
            {{missionStats.terminees}} terminées • {{missionStats.annulees}} annulées
          </div>
        </div>
        <div class="kpi-trend up">+12%</div>
      </div>

      <div class="kpi-card warning">
        <div class="kpi-icon">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
            <path d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"/>
          </svg>
        </div>
        <div class="kpi-content">
          <div class="kpi-value">{{entretienStats.enRetard}}</div>
          <div class="kpi-label">Entretiens en Retard</div>
          <div class="kpi-details">
            {{entretienStats.planifies}} planifiés • {{entretienStats.enCours}} en cours
          </div>
        </div>
        <div class="kpi-trend down">-5%</div>
      </div>

      <div class="kpi-card danger">
        <div class="kpi-icon">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
            <path d="M10,21H14A2,2 0 0,1 12,23A2,2 0 0,1 10,21M21,19V20H3V19L5,17V11C5,7.9 7.03,5.17 10,4.29C10,4.19 10,4.1 10,4A2,2 0 0,1 12,2A2,2 0 0,1 14,4C14,4.1 14,4.19 14,4.29C16.97,5.17 19,7.9 19,11V17L21,19Z"/>
          </svg>
        </div>
        <div class="kpi-content">
          <div class="kpi-value">{{alertesCritiques}}</div>
          <div class="kpi-label">Alertes Critiques</div>
          <div class="kpi-details">
            Intervention requise immédiatement
          </div>
        </div>
        <div class="kpi-trend neutral">0</div>
      </div>
    </div>
  </div>

  <!-- B. Graphiques et Visualisations -->
  <div class="charts-section">
    <div class="charts-grid">
      <!-- État Global des Véhicules -->
      <div class="chart-card">
        <div class="chart-header">
          <h3>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M11,2V22C5.9,21.5 2,17.2 2,12C2,6.8 5.9,2.5 11,2M13,2V11H22C22,6.8 18.1,2.5 13,2Z"/>
            </svg>
            État Global des Véhicules
          </h3>
          <button class="chart-action" (click)="ajouterVehicule()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
            </svg>
          </button>
        </div>
        <div class="chart-content">
          <div class="pie-chart">
            <div class="pie-data">
              <div class="pie-item disponible">
                <div class="pie-color"></div>
                <div class="pie-info">
                  <span class="pie-label">Disponibles</span>
                  <span class="pie-value">{{vehicleStats.disponible}} ({{getVehicleStatusPercentage('disponible')}}%)</span>
                </div>
              </div>
              <div class="pie-item mission">
                <div class="pie-color"></div>
                <div class="pie-info">
                  <span class="pie-label">En Mission</span>
                  <span class="pie-value">{{vehicleStats.enMission}} ({{getVehicleStatusPercentage('enMission')}}%)</span>
                </div>
              </div>
              <div class="pie-item maintenance">
                <div class="pie-color"></div>
                <div class="pie-info">
                  <span class="pie-label">Maintenance</span>
                  <span class="pie-value">{{vehicleStats.enMaintenance}} ({{getVehicleStatusPercentage('enMaintenance')}}%)</span>
                </div>
              </div>
              <div class="pie-item hors-service">
                <div class="pie-color"></div>
                <div class="pie-info">
                  <span class="pie-label">Hors Service</span>
                  <span class="pie-value">{{vehicleStats.horsService}} ({{getVehicleStatusPercentage('horsService')}}%)</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Utilisation des Missions -->
      <!-- Évolution Missions avec courbe fluide -->
      <div class="chart-card mission-evolution-card">
        <div class="chart-header">
          <h3>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M3.5 18.49l6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99l1.5 1.5z"/>
            </svg>
            Évolution Missions (6 mois)
          </h3>
          <div class="chart-actions">
            <div class="mission-stats">
              <span class="trend-value">+12.5%</span>
              <span class="trend-label">vs mois dernier</span>
            </div>
            <button class="chart-action" (click)="nouvelleMission()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
              </svg>
            </button>
          </div>
        </div>
        <div class="chart-content">
          <div class="line-chart-container">
            <div class="chart-legend">
              <div class="legend-item">
                <div class="legend-color missions-line"></div>
                <span>Missions quotidiennes</span>
              </div>
              <div class="chart-period">{{getMissionChartPeriod()}}</div>
            </div>
            
            <div class="line-chart" #missionChart>
              <svg width="100%" height="280" viewBox="0 0 800 280">
                <!-- Grid Lines -->
                <defs>
                  <linearGradient id="missionLineGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:0.3"/>
                    <stop offset="100%" style="stop-color:#3b82f6;stop-opacity:0"/>
                  </linearGradient>
                  <filter id="dropshadow">
                    <feGaussianBlur in="SourceAlpha" stdDeviation="3"/>
                    <feOffset dx="0" dy="2" result="offset"/>
                    <feComponentTransfer>
                      <feFuncA type="linear" slope="0.2"/>
                    </feComponentTransfer>
                    <feMerge>
                      <feMergeNode/>
                      <feMergeNode in="SourceGraphic"/>
                    </feMerge>
                  </filter>
                </defs>
                
                <!-- Background Grid -->
                <g class="grid-lines">
                  <line *ngFor="let y of getGridYLines()" [attr.x1]="60" [attr.x2]="760" [attr.y1]="y" [attr.y2]="y" stroke="#f1f5f9" stroke-width="1"/>
                  <line *ngFor="let x of getGridXLines()" [attr.x1]="x" [attr.x2]="x" [attr.y1]="40" [attr.y2]="220" stroke="#f1f5f9" stroke-width="1"/>
                </g>
                
                <!-- Y-axis Labels -->
                <g class="y-axis-labels">
                  <text *ngFor="let label of getYAxisLabels(); let i = index" 
                        [attr.x]="45" 
                        [attr.y]="220 - (i * 45) + 5" 
                        text-anchor="end" 
                        fill="#64748b" 
                        font-size="12" 
                        font-family="Inter, sans-serif">
                    {{label}}
                  </text>
                </g>
                
                <!-- X-axis Labels -->
                <g class="x-axis-labels">
                  <text *ngFor="let label of missionEvolutionData.labels; let i = index" 
                        [attr.x]="60 + (i * (700 / (missionEvolutionData.labels.length - 1)))" 
                        [attr.y]="245" 
                        text-anchor="middle" 
                        fill="#64748b" 
                        font-size="11" 
                        font-family="Inter, sans-serif">
                    {{label}}
                  </text>
                </g>
                
                <!-- Area under the curve -->
                <path 
                  [attr.d]="getMissionAreaPath()" 
                  fill="url(#missionLineGradient)" 
                  opacity="0.6"/>
                
                <!-- Main line curve -->
                <path 
                  [attr.d]="getMissionLinePath()" 
                  fill="none" 
                  stroke="#3b82f6" 
                  stroke-width="3" 
                  stroke-linecap="round" 
                  stroke-linejoin="round"
                  filter="url(#dropshadow)"
                  class="mission-curve">
                </path>
                
                <!-- Data points -->
                <g class="data-points">
                  <circle *ngFor="let point of getMissionDataPoints(); let i = index"
                          [attr.cx]="point.x" 
                          [attr.cy]="point.y" 
                          r="4" 
                          fill="#ffffff" 
                          stroke="#3b82f6" 
                          stroke-width="3"
                          class="data-point"
                          [attr.data-value]="missionEvolutionData.data[i]"
                          [attr.data-label]="missionEvolutionData.labels[i]"
                          (mouseenter)="showTooltip($event, missionEvolutionData.data[i], missionEvolutionData.labels[i])"
                          (mouseleave)="hideTooltip()">
                  </circle>
                </g>
                
                <!-- Peak and Valley indicators -->
                <g class="peak-valley-indicators">
                  <g *ngFor="let peak of getMissionPeaks()">
                    <circle [attr.cx]="peak.x" [attr.cy]="peak.y - 15" r="3" fill="#10b981" opacity="0.8"/>
                    <text [attr.x]="peak.x" [attr.y]="peak.y - 25" text-anchor="middle" fill="#10b981" font-size="10" font-weight="600">↗</text>
                  </g>
                  <g *ngFor="let valley of getMissionValleys()">
                    <circle [attr.cx]="valley.x" [attr.cy]="valley.y + 15" r="3" fill="#ef4444" opacity="0.8"/>
                    <text [attr.x]="valley.x" [attr.y]="valley.y + 28" text-anchor="middle" fill="#ef4444" font-size="10" font-weight="600">↘</text>
                  </g>
                </g>
              </svg>
            </div>

            <!-- Chart Statistics -->
            <div class="chart-stats">
              <div class="stat-item">
                <span class="stat-label">Moyenne journalière</span>
                <span class="stat-value">{{getMissionDailyAverage()}} missions</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">Pic maximum</span>
                <span class="stat-value">{{getMissionMaxValue()}} missions</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">Tendance</span>
                <span class="stat-value" [class]="getMissionTrendClass()">{{getMissionTrend()}}</span>
              </div>
            </div>

            <!-- Tooltip -->
            <div class="chart-tooltip" [style.display]="showMissionTooltip ? 'block' : 'none'" [style.left.px]="tooltipX" [style.top.px]="tooltipY">
              <div class="tooltip-content">
                <div class="tooltip-date">{{tooltipDate}}</div>
                <div class="tooltip-value">{{tooltipValue}} missions</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Indicateurs de Performance -->
      <div class="chart-card span-2">
        <div class="chart-header">
          <h3>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2Z"/>
            </svg>
            Indicateurs de Performance
          </h3>
          <div class="chart-actions">
            <span class="performance-score">Score Global: <strong>89%</strong></span>
          </div>
        </div>
        <div class="chart-content">
          <div class="performance-grid">
            <div class="performance-item">
              <div class="performance-header">
                <span class="performance-label">Consommation Carburant</span>
                <span class="performance-value">{{consommationCarburant}}L</span>
              </div>
              <div class="performance-bar">
                <div class="bar-fill" style="width: 75%"></div>
              </div>
              <div class="performance-details">
                <span>-8% vs mois dernier</span>
                <span class="trend down">↓</span>
              </div>
            </div>
            <div class="performance-item">
              <div class="performance-header">
                <span class="performance-label">Coût Moyen Mission</span>
                <span class="performance-value">{{coutMoyenMission}} TND</span>
              </div>
              <div class="performance-bar">
                <div class="bar-fill" style="width: 68%"></div>
              </div>
              <div class="performance-details">
                <span>+3% vs mois dernier</span>
                <span class="trend up">↑</span>
              </div>
            </div>
            <div class="performance-item">
              <div class="performance-header">
                <span class="performance-label">Taux Disponibilité</span>
                <span class="performance-value">{{getVehicleStatusPercentage('disponible')}}%</span>
              </div>
              <div class="performance-bar">
                <div class="bar-fill success" style="width: 92%"></div>
              </div>
              <div class="performance-details">
                <span>Objectif: 85%</span>
                <span class="trend up">✓</span>
              </div>
            </div>
            <div class="performance-item">
              <div class="performance-header">
                <span class="performance-label">Personnel Actif</span>
                <span class="performance-value">{{totalUtilisateurs}}</span>
              </div>
              <div class="performance-bar">
                <div class="bar-fill" style="width: 85%"></div>
              </div>
              <div class="performance-details">
                <span>24 connectés aujourd'hui</span>
                <span class="trend neutral">→</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- C. Listes d'Éléments Récents -->
  <div class="recent-section">
    <div class="recent-grid">
      <!-- 5 Dernières Missions -->
      <div class="recent-card">
        <div class="recent-header">
          <h3>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z"/>
            </svg>
            Missions Récentes
          </h3>
          <button class="recent-action" (click)="nouvelleMission()">Voir tout</button>
        </div>
        <div class="recent-list">
          <div class="recent-item" *ngFor="let mission of recentMissions">
            <div class="item-icon">
              <div class="status-indicator" [class]="'status-' + mission.status"></div>
            </div>
            <div class="item-content">
              <div class="item-title">{{mission.titre}}</div>
              <div class="item-subtitle">{{mission.vehicule}} • {{mission.conducteur}}</div>
              <div class="item-meta">{{mission.destination}} • {{formatDateShort(mission.dateDebut)}}</div>
            </div>
            <div class="item-badge" [class]="'badge-' + mission.status">
              {{getMissionStatusLabel(mission.status)}}
            </div>
          </div>
        </div>
      </div>

      <!-- Derniers Entretiens -->
      <div class="recent-card">
        <div class="recent-header">
          <h3>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"/>
            </svg>
            Entretiens à Venir
          </h3>
          <button class="recent-action" (click)="planifierEntretien()">Planifier</button>
        </div>
        <div class="recent-list">
          <div class="recent-item" *ngFor="let entretien of recentEntretiens">
            <div class="item-icon">
              <div class="priority-indicator" [class]="'priority-' + entretien.priorite"></div>
            </div>
            <div class="item-content">
              <div class="item-title">{{entretien.type}}</div>
              <div class="item-subtitle">{{entretien.vehicule}} • {{entretien.technicien}}</div>
              <div class="item-meta">{{formatDateShort(entretien.datePrevue)}}</div>
            </div>
            <div class="item-badge" [class]="'badge-' + entretien.status">
              {{getEntretienStatusLabel(entretien.status)}}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- D. Alertes et Notifications Critiques -->
  <div class="alerts-section" *ngIf="alertes.length > 0">
    <div class="alerts-header">
      <h3>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M10,21H14A2,2 0 0,1 12,23A2,2 0 0,1 10,21M21,19V20H3V19L5,17V11C5,7.9 7.03,5.17 10,4.29C10,4.19 10,4.1 10,4A2,2 0 0,1 12,2A2,2 0 0,1 14,4C14,4.1 14,4.19 14,4.29C16.97,5.17 19,7.9 19,11V17L21,19Z"/>
        </svg>
        Alertes Critiques ({{alertes.length}})
      </h3>
    </div>
    <div class="alerts-list">
      <div class="alert-item" *ngFor="let alerte of alertes" [class]="'alert-' + alerte.severity">
        <div class="alert-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M13,14H11V10H13M13,18H11V16H13M1,21H23L12,2L1,21Z"/>
          </svg>
        </div>
        <div class="alert-content">
          <div class="alert-title">{{alerte.titre}}</div>
          <div class="alert-message">{{alerte.message}}</div>
          <div class="alert-time">{{formatDateShort(alerte.dateCreation)}}</div>
        </div>
        <div class="alert-actions">
          <button class="alert-btn-details" (click)="voirDetailsAlerte(alerte)">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/>
            </svg>
          </button>
          <button class="alert-btn-dismiss" (click)="dismissAlerte(alerte)">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
              <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- E. Actions Rapides -->
  <div class="quick-actions-section">
    <div class="quick-actions-header">
      <h3>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M13,3A9,9 0 0,0 4,12H1L4.89,15.89L4.96,16.03L9,12H6A7,7 0 0,1 13,5A7,7 0 0,1 20,12A7,7 0 0,1 13,19C11.07,19 9.32,18.21 8.06,16.94L6.64,18.36C8.27,20 10.5,21 13,21A9,9 0 0,0 22,12A9,9 0 0,0 13,3Z"/>
        </svg>
        Actions Rapides
      </h3>
      <div class="actions-tip">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z"/>
        </svg>
        Accès rapide aux fonctionnalités principales
      </div>
    </div>
    <div class="quick-actions-grid">
      <button class="action-card primary" (click)="nouvelleMission()">
        <div class="action-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z"/>
          </svg>
        </div>
        <div class="action-content">
          <div class="action-title">Nouvelle Mission</div>
          <div class="action-subtitle">Créer et assigner</div>
        </div>
      </button>

      <button class="action-card accent" (click)="ajouterVehicule()">
        <div class="action-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11C5.84 5 5.28 5.42 5.08 6.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99z"/>
          </svg>
        </div>
        <div class="action-content">
          <div class="action-title">Ajouter Véhicule</div>
          <div class="action-subtitle">Nouveau dans le parc</div>
        </div>
      </button>

      <button class="action-card warning" (click)="planifierEntretien()">
        <div class="action-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M22.7 19l-9.1-9.1c.9-2.3.4-5-1.5-6.9-2-2-5-2.4-7.4-1.3L9 6 6 9 1.6 4.7C.4 7.1.9 10.1 2.9 12.1c1.9 1.9 4.6 2.4 6.9 1.5l9.1 9.1c.4.4 1 .4 1.4 0l2.3-2.3c.5-.4.5-1.1.1-1.4z"/>
          </svg>
        </div>
        <div class="action-content">
          <div class="action-title">Planifier Entretien</div>
          <div class="action-subtitle">Maintenance préventive</div>
        </div>
      </button>

      <button class="action-card success" (click)="creerUtilisateur()">
        <div class="action-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z"/>
          </svg>
        </div>
        <div class="action-content">
          <div class="action-title">Nouvel Utilisateur</div>
          <div class="action-subtitle">Gestion personnel</div>
        </div>
      </button>

      <button class="action-card info" (click)="ajouterBonCarburant()">
        <div class="action-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19.77,7.23L19.78,7.22L16.06,3.5L15,4.56L17.11,6.67C16.17,7.03 15.5,7.93 15.5,9V16.5C15.5,17.88 16.62,19 18,19C19.38,19 20.5,17.88 20.5,16.5V9C20.5,8.31 20.22,7.68 19.77,7.23M18.5,9V16.5C18.5,16.78 18.28,17 18,17C17.72,17 17.5,16.78 17.5,16.5V9C17.5,8.72 17.72,8.5 18,8.5C18.28,8.5 18.5,8.72 18.5,9M14,20H2V6H14V20M4,8V18H12V8H4Z"/>
          </svg>
        </div>
        <div class="action-content">
          <div class="action-title">Bon Carburant</div>
          <div class="action-subtitle">Gestion fuel</div>
        </div>
      </button>
    </div>
  </div>

  <!-- F. Flux d'Activité Récent -->
  <div class="activity-section">
    <div class="activity-header">
      <h3>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z"/>
        </svg>
        Activité Récente
      </h3>
    </div>
    <div class="activity-timeline">
      <div class="timeline-item" *ngFor="let activite of activitesRecentes">
        <div class="timeline-icon">{{activite.icone}}</div>
        <div class="timeline-content">
          <div class="timeline-title">{{activite.action}}</div>
          <div class="timeline-details">{{activite.details}}</div>
          <div class="timeline-meta">
            <span class="timeline-user">{{activite.utilisateur}}</span>
            <span class="timeline-time">{{formatDateShort(activite.timestamp)}}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- REPORTS & NOTIFICATIONS SECTION -->
  <!-- ============================================ -->
  <div class="reports-notifications-section">
    <div class="section-header">
      <h3>
        <div class="header-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
          </svg>
        </div>
        Rapports & Notifications
      </h3>
      <p>Gestion des rapports automatisés et système de notifications en temps réel</p>
    </div>

    <div class="reports-notifications-grid">
      <!-- RAPPORTS SECTION -->
      <div class="reports-card">
        <div class="card-header">
          <h4>
            <div class="card-icon">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M9,17H7V10H9V17M13,17H11V7H13V17M17,17H15V13H17V17M19.5,19.1H4.5V5H19.5V19.1Z"/>
              </svg>
            </div>
            Rapports Disponibles
          </h4>
          <button class="card-action" (click)="generateAllReports()">
            Générer Tout
          </button>
        </div>

        <div class="reports-list">
          <div class="report-item" *ngFor="let report of availableReports" (click)="openReport(report)">
            <div class="report-icon" [class]="report.type">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path [attr.d]="getReportIcon(report.type)"/>
              </svg>
            </div>
            
            <div class="report-content">
              <div class="report-title">{{report.title}}</div>
              <div class="report-description">{{report.description}}</div>
              <div class="report-meta">
                <div class="report-date">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19,3H18V1H16V3H8V1H6V3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M19,19H5V8H19V19Z"/>
                  </svg>
                  {{formatDateShort(report.lastGenerated)}}
                </div>
                <div class="report-size">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M6,2A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z"/>
                  </svg>
                  {{report.fileSize}}
                </div>
              </div>
            </div>

            <div class="report-status" [class]="report.status">
              {{getReportStatusText(report.status)}}
            </div>

            <div class="report-actions">
              <button class="action-btn download" 
                      [disabled]="report.status !== 'ready'" 
                      (click)="downloadReport(report, $event)" 
                      title="Télécharger">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"/>
                </svg>
              </button>
              <button class="action-btn view" 
                      [disabled]="report.status !== 'ready'" 
                      (click)="viewReport(report, $event)" 
                      title="Aperçu">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- NOTIFICATIONS SECTION -->
      <div class="notifications-card">
        <div class="card-header">
          <h4>
            <div class="card-icon">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M21,19V20H3V19L5,17V11C5,7.9 7.03,5.17 10,4.29C10,4.19 10,4.1 10,4A2,2 0 0,1 12,2A2,2 0 0,1 14,4C14,4.1 14,4.19 14,4.29C16.97,5.17 19,7.9 19,11V17L21,19M14,21A2,2 0 0,1 12,23A2,2 0 0,1 10,21"/>
              </svg>
            </div>
            Centre de Notifications
          </h4>
          <button class="card-action" (click)="markAllAsRead()">
            Tout Marquer Lu
          </button>
        </div>

        <div class="notifications-stats">
          <div class="stat-item">
            <div class="stat-number">{{getNotificationCount('unread')}}</div>
            <div class="stat-label">Non Lues</div>
          </div>
          <div class="stat-item">
            <div class="stat-number">{{getNotificationCount('today')}}</div>
            <div class="stat-label">Aujourd'hui</div>
          </div>
          <div class="stat-item">
            <div class="stat-number">{{getNotificationCount('urgent')}}</div>
            <div class="stat-label">Urgentes</div>
          </div>
        </div>

        <div class="notifications-list">
          <div class="notification-item" 
               *ngFor="let notification of recentNotifications" 
               [class.unread]="!notification.isRead"
               (click)="readNotification(notification)">
            
            <div class="notification-indicator"></div>
            
            <div class="notification-icon" [class]="notification.type">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path [attr.d]="getNotificationIcon(notification.type)"/>
              </svg>
            </div>
            
            <div class="notification-content">
              <div class="notification-title">{{notification.title}}</div>
              <div class="notification-message">{{notification.message}}</div>
              <div class="notification-time">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z"/>
                </svg>
                {{getRelativeTime(notification.timestamp)}}
              </div>
            </div>
            
            <div class="notification-actions">
              <button class="action-btn mark-read" 
                      *ngIf="!notification.isRead"
                      (click)="markAsRead(notification, $event)" 
                      title="Marquer comme lu">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/>
                </svg>
              </button>
              <button class="action-btn dismiss" 
                      (click)="dismissNotification(notification, $event)" 
                      title="Supprimer">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>
